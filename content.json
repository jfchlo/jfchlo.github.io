{"meta":{"title":"映 像","subtitle":null,"description":null,"author":"JF","url":"https://jfchl.cn"},"pages":[],"posts":[{"title":"","slug":"JupyterToMarkdownTest","date":"2018-09-08T15:04:35.931Z","updated":"2018-09-08T15:28:02.802Z","comments":true,"path":"2018/09/08/JupyterToMarkdownTest/","link":"","permalink":"https://jfchl.cn/2018/09/08/JupyterToMarkdownTest/","excerpt":"","text":"layout:title: 青海湖date: 2018-09-08 23:20:51tags: jupyter markdowncategories: 数据分析photos: /photos/JupyterToMarkdownTest/output_14_0.png 这是半年前用jupyter完成，今日转换成md放到这里作为一个测试 销售描述统计与 matplib 以一月份份的销售为例： 1234567import osimport pandas as pdimport matplotlib.pyplot as pltname=['单号','销售日期','商品编码','商品名称','车型','仓位','销售数量','销售单价','销售金额']os.chdir('e:')df1=pd.read_excel('./zyxiaoshou.xlsx',sheetname='Sheet5',header=0,names=name)df1.head() 单号 销售日期 商品编码 商品名称 车型 仓位 销售数量 销售单价 销售金额 0 SEL1605310001 2016-05-31 0501120615-003 车门铰链 NJP AA 1 12.0 12.0 1 SEL1605310001 2016-05-31 0501120708-001 锁体 NJP AA 1 16.0 16.0 2 SEL1605310002 2016-05-31 0303100406-001 后制动底板 FT AB 1 90.0 90.0 3 SEL1605310003 2016-05-31 0601013409-001 排气制动阀 CDW 王牌库 1 87.0 87.0 4 SEL1605310003 2016-05-31 0601060304-014 后轮毂 CDW 王牌库 1 218.8 218.8 这是一月份总体销售情况，来做个初步的统计描述,总销售金额，各个仓位的销售金额(包含了销售退单）看看pandas的透视表函授怎么实现上述功能 pd.pivot_table 12sel_table=df1.pivot_table(index='仓位',values=['销售金额'],aggfunc=sum,margins_name='销售总计',margins=True)sel_table 销售金额 仓位 AA 119338.44 AB 59614.94 AF -2224.00 王牌库 124863.98 福田库 168834.13 轮胎库 35870.00 销售总计 506297.49 12sel_table=df1.pivot_table(index='商品名称',values=['销售数量','销售金额'],aggfunc=sum)sel_table.sort_values(by='销售金额',ascending=False)[0:10] 销售数量 销售金额 商品名称 发动机总成 5 51328.70 驾驶室空壳 5 44360.00 轮胎 203 35646.00 保险杠 87 15155.11 齿轮油 273 14013.00 驾驶室总成 1 13000.00 后视镜 777 12639.10 前大灯 105 12065.88 散热器总成 26 11505.91 柴油机油 143 10672.90 销售数据在一个工作薄中8个不同滴表中，看否能合并为一个 12345678910import osimport pandas as pdimport matplotlib.pyplot as pltname=['单号','销售日期','商品编码','商品名称','车型','仓位','销售数量','销售单价','销售金额']os.chdir('e:')df=[]for i in range(1,13): df.append(pd.read_excel('./zyxiaoshou.xlsx',sheetname='Sheet'+str(i),header=0,names=name))data=pd.concat(df)data.index=[data['销售日期']] 1data.tail() 单号 销售日期 商品编码 商品名称 车型 仓位 销售数量 销售单价 销售金额 销售日期 2016-12-01 SEL1612010026 2016-12-01 03021613-112 散热器总成 FT 福田库 1 575.09 575.09 2016-12-01 SEL1612010027 2016-12-01 0302121201-022 挡泥板 FT 福田库 2 90.00 180.00 2016-12-01 SEL1612010027 2016-12-01 0302121201-023 挡泥板 FT 福田库 1 90.00 90.00 2016-12-01 SEL1612010027 2016-12-01 0302121205-046 轮罩 FT 福田库 1 52.00 52.00 2016-12-01 SEL1612010027 2016-12-01 0302121205-047 轮罩 FT AB 1 52.00 52.00 1len(data) 33932 1from datetime import datetime 12sel_table=data.pivot_table(index='销售日期',columns='仓位',values='销售金额',aggfunc=sum,fill_value=0)sel_table.head() 仓位 AA AB AC AF BA RR Z 整车 王牌库 王牌旧件库 福田库 福田旧件库 轮胎库 销售日期 2016-01-02 2665.5 2157.00 0 -25.0 0 0 0 0 1340.00 0 8472.89 0.0 0.0 2016-01-03 4155.0 2835.72 0 -259.5 0 0 0 0 7509.70 0 3874.55 0.0 0.0 2016-01-04 26055.0 2803.56 0 -80.0 0 0 0 0 3851.48 0 5751.85 0.0 0.0 2016-01-05 11263.0 6323.11 0 0.0 0 0 0 0 1978.50 0 3278.50 0.0 0.0 2016-01-06 1223.0 1529.00 0 0.0 0 0 0 0 1081.80 0 3100.43 0.0 0.0 12#每月各个仓库的销售汇总sel_table.resample('m').sum() 仓位 AA AB AC AF BA RR Z 整车 王牌库 王牌旧件库 福田库 福田旧件库 轮胎库 销售日期 2016-01-31 127682.80 92014.75 0 -2761.30 0 0 -200 0 124957.82 -65 125930.35 0.00 0.00 2016-02-29 62677.00 36036.51 0 -741.50 0 0 0 0 51051.23 0 116428.23 0.00 0.00 2016-03-31 258884.70 127815.22 0 -4070.72 74 0 0 0 209483.66 0 301219.34 0.00 0.00 2016-04-30 136980.02 54074.05 0 -1972.50 0 0 0 0 182166.40 0 187852.54 0.00 27648.00 2016-05-31 119338.44 59614.94 0 -2224.00 0 0 0 0 124863.98 0 168834.13 0.00 35870.00 2016-06-30 94775.62 95951.11 0 -2370.54 0 4154000 0 91800 125914.73 0 189296.92 0.00 22858.00 2016-07-31 90293.42 66642.80 -70 -2625.00 0 1124660 0 0 90984.31 0 110750.86 -914.03 34125.00 2016-08-31 80870.88 43727.09 0 -1636.00 0 171048 0 255800 63678.54 0 92951.81 -345.00 41848.00 2016-09-30 114232.58 48921.98 0 -3032.00 0 0 0 264300 94730.09 0 105888.18 -16.00 36781.90 2016-10-31 96081.60 58120.44 0 -3359.50 0 0 0 180000 64260.25 0 88486.43 -285.08 25395.16 2016-11-30 99597.10 34259.78 0 -2770.50 0 0 0 268197 50649.67 0 99196.55 0.00 52674.37 2016-12-31 99297.45 53077.18 0 -534.50 0 0 0 98000 49910.29 0 113013.72 0.00 22431.87 123456789101112t1=sel_table.resample('m').sum().ix[:,['福田库','王牌库','AA','AB','整车','轮胎库']]plt.rcParams['font.sans-serif']=['SimHei']plt.rcParams['axes.unicode_minus']=Falset1.plot(figsize=(10,3),rot=30)plt.legend()plt.grid(True)plt.xlabel('月份')plt.ylabel('销售金额')plt.title('2016年1-8月份分库销售统计')plt.show() 1234567t2=t1.resample('m').sum().sum(axis=1)t2.plot(figsize=(10,3),rot=30)plt.grid(True)plt.ylabel('销售金额(万元)')plt.xlabel('月份')plt.show() 123456789101112t1.sum(axis=1).plot(figsize=(10,3),rot=45,style='bo-')plt.grid(True)plt.title('总体销售')plt.ylabel('销售金额')plt.xlabel('销售月份')for i in range(len(t1)): plt.annotate(t1.sum(axis=1).values[i], xy=(t1.index[i],t1.sum(axis=1)[i]), xytext=(t1.index[i],t1.sum(axis=1)[i]) ) plt.show() 123import numpy as npa=pd.Series([1,2,3])a[1] 2 12t1.plot(subplots=True,figsize=(6,10),sharey=True,grid=True)plt.show() 12t1.plot(subplots=True,figsize=(14,6),layout=(2,3),sharey=True,sharex=False,grid=True)plt.show() 12t1.sum(axis=0).plot.pie(figsize=(6,6),autopct='%.2f')plt.show() 12t1.plot.area(figsize=(12,6))plt.show() 12345678910import osimport pandas as pdimport matplotlib.pyplot as pltname=['单号','销售日期','商品编码','商品名称','车型','仓位','销售数量','销售单价','销售金额']os.chdir('e:')df=[]for i in range(1,12): df.append(pd.read_excel('./zyxiaoshou.xlsx',sheetname='Sheet'+str(i),header=0,names=name))data=pd.concat(df)data.to_excel('./zyqp.xls')","categories":[],"tags":[]},{"title":"青海湖","slug":"qinghaihu","date":"2018-09-08T14:04:51.000Z","updated":"2018-09-08T14:22:36.745Z","comments":true,"path":"2018/09/08/qinghaihu/","link":"","permalink":"https://jfchl.cn/2018/09/08/qinghaihu/","excerpt":"","text":"","categories":[{"name":"PHOTOS","slug":"PHOTOS","permalink":"https://jfchl.cn/categories/PHOTOS/"}],"tags":[{"name":"photos","slug":"photos","permalink":"https://jfchl.cn/tags/photos/"}]},{"title":"justifiedGallery-test","slug":"facybox-test","date":"2018-09-05T07:04:51.000Z","updated":"2018-09-05T12:40:24.958Z","comments":true,"path":"2018/09/05/facybox-test/","link":"","permalink":"https://jfchl.cn/2018/09/05/facybox-test/","excerpt":"","text":"本想出发之前完成。。。。。。","categories":[{"name":"PHOTOS","slug":"PHOTOS","permalink":"https://jfchl.cn/categories/PHOTOS/"}],"tags":[{"name":"photos","slug":"photos","permalink":"https://jfchl.cn/tags/photos/"}]},{"title":"Hello World","slug":"hello-world","date":"2018-07-25T14:17:16.784Z","updated":"2018-07-30T05:52:19.237Z","comments":true,"path":"2018/07/25/hello-world/","link":"","permalink":"https://jfchl.cn/2018/07/25/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}